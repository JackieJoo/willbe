# Внутрішня будова 

### Секція
[**Секція**](#section) - вища структурна одиниця `will-файла`, яка складається з ресурсів одного типу. Є шість секцій для побудови модуля користувачем: `about`, `path`, `submodule`, `step`, `reflector`, `build` та одна секція, яка генерується утилітою `willbe` при експорті модуля - секція `exported`. Порядок розташування і кількість секцій в `will-файлі` визначається його призначенням.  
Приклад `will-файла`:  

![will.file.inner.png](./Images/will.file.inner.png)  

##### Опис секцій  
[**About.**](#about) В секції поміщено основну інформація про модуль - назва, версія, опис...    
Структура полів секції `about`:  

| Поле           | Опис                                    |
|----------------|-----------------------------------------|
| name           | назва модуля                            |
| description    | опис (коротка характеристика модуля) - призначення, ліцензія, автори та ін.    |
| version        | версія модуля - для позначення прогресу розробки та стану продукту             |
| enabled        | поле, яке генерується в оперативну пам'ять утилітою `willbe` для виконання побудови; значення за замовчуванням '1' |
| interpreters   | інтерпретатори, які потрібні модулю     |
| keywords       | ключові слова                           |  

[**Path.**](#path) Секція представляє карту шляхів модуля для швидкого орієнтування в його структурі. Секція має три вбудовані шляхи: `in`, `out` та `temp`. Директорія на яку вказує `in` - точка відліку для відносних шляхів модуля, тобто, утиліта `willbe` зчитує шлях до ресурсу відносно каталогу `in`, `out` - директорія для експортованих модулів, `temp` - поміщаються тимчасові файли. Якщо `in` не вказаний, то `willbe` починає відлік від кореневої директорії `will`-файла.  
Ресурси секції `path` включають поля:   

| Поле           | Опис                                        |
|----------------|---------------------------------------------|
| path           | шлях до директорії (абсолютний, відносний)  |
| description    | опис директорії                             |
| criterion      | умова використання ресурса (див. критеріон) |
| inherit        | наслідування значень полів іншого ресурса   |  

[**Submodule.**](#submodule) В секції вказуються підмодулі.  
Ресурси секції `submodule` включають поля:  

| Поле           | Опис                                           |
|----------------|------------------------------------------------|
| path           | шлях до підмодуля (абсолютний, відносний, URL) |
| description    | опис підмодуля                                 |
| criterion      | умова використання ресурса (див. критеріон)    |
| inherit        | наслідування значень полів іншого ресурса      |  

[**Step**](#step) Ресурси секції (кроки) описують процедури побудови модуля. Кроки поміщають в сценарії збірок секції `build` для виконання побудови.  
Ресурси секції `step` включають поля:   

| Поле           | Опис                                        |
|----------------|---------------------------------------------|
| description    | опис кроку (процедури)                      |
| criterion      | умова використання ресурса (див. критеріон) |
| opts           | процедура побудови модуля                   |
| inherit        | наслідування значень полів іншого ресурса   |

[**Reflector.**](#reflector) Основними функціями ресурсів секції (рефлекторів) є файлові операції (вибір файлів (директорій), копіювання і т.д.).  
Ресурси секції `step` включають поля:    

| Поле           | Опис                                                       |
|----------------|------------------------------------------------------------|
| description    | опис рефлектора                                            |
| recursive      | опція, яка визначає рівень зчитування структури директорії |
| filePath       | шляхи до файлів модуля (абсолютний, відносний)             |
| src            | вказуються шлях директорій та умови вибору файлів          |
| dst            | директорія в яку будут поміщено файли                      |
| criterion      | умова використання ресурса (див. критеріон)                |
| inherit        | наслідування значень полів іншого ресурса    |

<a name="execution"></a> **Execution.** Секція will-файлу яка описує варіанти виконання програми створення складної модульної системи (в стадії розробки).  
<a name="exported"></a> **Exported.** Секція will-файлу яка присутня виключно в автоматично згенерованому `*.out.will`-файлі. `*.out.will` може бути використаний як підмодуль складної системи.  
Структура полів секції `exported`:  

| Поле                     | Опис                                   |
|--------------------------|----------------------------------------|
| version                  | версія модуля, експортується з секції `about`                 |
| description              | опис (коротка характеристика модуля) - призначення, ліцензія, автори та ін. |
| criterion                | критерії, експортовані з секції `build` при виконанні збірки експорту |
| inherit                  | наслідування, яке експортується з секції `build` при виконанні збірки |
| exportedReflector        | рефлектор, який записується в експортованому will-файлі       |
| exportedFilesReflector   | рефлектор на експортовані файли                               |  
| exportedDirPath          | шляхи до директорій, що експотуються                          |
| exportedFilesPath        | шляхи до файлів, що експортуються                             |
| archiveFilePath          | експортовані шляхи для архівованих файлів створеного модулю   |

<a name="build"></a> **Build.** Секція will-файлу яка описує послідовність і умови виконання процедур створення модулю використовуючи значення інших секцій файлу та вбудованих функцій. Для корректної роботи в секції повинна бути присутня принаймні одна процедура.
Структура полів секції `build`:  

| Поле          | Опис                                    |
|---------------|-----------------------------------------|
| description   | пояснення до збірки модуля; необов'язковий поле                          |  
| criterion     | критерій виконання процедури створення модуля; обов'язкове поле          |
| steps         | процедури створення модуля, описані секцією `step` або вбудовані в утиліту; необов'язкове поле                |
| inherit       | наслідування збірником. Якщо вже є описана процедура, можливо включити її наслідування; необов'язкове поле  |

### Ресурси
[**Ресурси**](#resource) - елементи `will-файла`, які позначають певну функціональність. Ресурси секцій позначаються декларативно, тобто, вказується лише результат, який потрібно отримати, а послідовність дій для отримання результату опускається. Вигляд ресурсів окремих секцій відрізняється.   
На рисунку ресурс `Tools` секції `submodule` має скорочену форму запису, а ресурс `npm.install` секції `step` - повну (розширену):

![resource.png](./Images/resource.png)
