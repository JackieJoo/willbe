# Рефлектори в will-файлах

В керівництві користувача описуються рефлектори - призначення, особливості побудови, використання

### <a name="reflector-term"></a> Поняття рефлектора  
Рефлектор - це не тільки назва секції, чи одна функція утиліти `willbe`, а набір функціональностей для ефективного управління файловими ресурсами модульної системи. Основними функціями є сортування, групування файлів, зчитування, копіювання та переміщення.

### <a name="reflector-resource-structure"></a> Структура ресурсу рефлектора 
Ресурс рефлектора, як і інших складається з набору полів. До стандартних відносяться `description` - опис рефлектора, `criterion` - для порівняння мапи критеріонів при виборі рефлектора, `inherit` - наслідування користувацьких збірок або вбудованих рефлекторів. Є ще чотири унікальних поля: `recursive` - замикання процедури вибору файлів на себе з умовою виходу; `filePath` - шлях до файлів модуля; `src` - ресурси (шляхи) звідки буде зчитано файли; `dst` - директорія в яку будут поміщено файли.  
Поля `filePath`, `src`, `dst` мають ресурси які структурно розділені на шляхи, маски і фільтри.  
Дослідимо структуру і формат ресурсів.  

##### <a name="reflector-paths"></a> Шляхи 
Використовується поля `basePath`, `prefixPath` i `filePath`.  

`basePath` - базовий, основний шлях до файлів рефлектора. Подібно до шляху `in` в секції `step`, задає початкову точку відліку для шляхів. Може включати декілька базових шляхів для різних файлів. Зазвичай позначає поточну директорію '.' і не вказується полі `src`. Якщо поле `basePath` вказано в `will`-файлі і має значення відмінне від '.', то буде скопійовано `will`-модуль в кореневний каталог `will`-файла відносно вказаного шляху.  

```yaml
src :
  basePath :
    'some/file1' : './dir1'
    'some/file2' : './dir2'
  
```

Вказаний ресурс означає, що для `file1`, який знаходиться за шляхом `/some`, базовий шлях починається з директорії `./dir1` в кореневому каталозі `will`-файла. Для другого файла відповідно базовий шлях починається від директорії `./dir2`.  

`prefixPath` - шлях, який додається до `basePath` при створенні модуля.  
Тобто, якщо в полі вказаний `basePath` незалежно від `prefixPath`, то цей шлях є і базовим, і повним, а якщо разом з `prefixPath`, то до нього потрібно додавати префікс із шляху в `prefixPath`.

```yaml
src :
  basePath : '.'
  prefixPath : 'out/out.debug'
dst :
  filePath : '..'
  
```

Приклад показує, що файли будуть братись в директорії за шляхом `./out/out.debug/`, а поміщені в директорію на рівень вище від кореневої директорії `will`-файла.  

`filePath` - поле може бути незалежним або включеним в ресурси `src` i `dst` та позначає відповідні шляхи до файлів модуля орієнтовно `basePath`. Поле має структуру "ключ-значення", де ключем є шлях до файла, а значенням - його істинність (_true, false_), якщо значення не вказане, то за замовчуванням `true`. Також, значенням може бути інша директорія - виконання операції копіювання.  

```yaml
filePath :
  some/file1 : true
  file2 : false
  
```

В секцію поміщено шляхи до двох файлів відносно `basePath`. `file1` включений і буде використовуватись при створенні модуля, а `file2` - ні. Також, можна записати так:

```yaml
filePath :
  some/file1
  
```

При операції копіювання в поле `filePath` записуються два шляхи:

```yaml
filePath :
  /some/file1 : /dir2/
  
```

Буде скопійовано `file1` до директорії `dir2`.