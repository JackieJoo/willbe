### Селектор

Рядок-посилання на ресурс або декілька ресурсів модуля.

### Селектор з ґлобом

Селектор, який для вибору ресурсу використовує пошукові шаблони - ґлоби.  

[Globbing](https://linuxhint.com/bash_globbing_tutorial/) - представляє собою аналог регулярних виразів  для пошуку файлів в bash-терміналі.  

![selector.png](./Images/selector.png)

На рисунку в збірці `export` використовується два види селекторів. Селектор `step::export.*` є ґлобом бо містить `*`, читається: "вибрати всі кроки, які починаються на `export.`". Цей селектро може обрати кроки `export.single` i `export.multi` (позначено синіми стрілками). Вибір кроку здійснюється [порівнянням мапи критеріонів](Criterions.md). Аналогічно здійснюється вибір шляху селектором `path::fileToExport.*` кроками `step::export.single` i `step::export.multi`.  

Селектори `step::delete.out` в збірці `export` і `path::out` в кроці `delete.out` - прості - мають пряме посилання на ресурс.  В `will-файлі` використовуються селектори вигляду `Тип ресурса :: Назва ресурса`.

### Ґлоб з ассертом

Спеціальна синтаксична конструкція, що додається до ґлоба в для обмеження кількості ресурсів, що мають бути знайдені селектором із цим ґлобом.

```yml
path :

  out.debug :
    path : './out/debug'
    criterion :
      debug : 1
  out.release :
    path : './out/release'
    criterion :
      debug : 0

step :

  export :
    export : path::out.*=1
    criterion :
      debug : 0
```

Крок `step::export` повинен вибрати один шлях `path::out.debug`. Так, як це цілком прогнозований і очікуваний результат то ророзбник помістив в селектро `path::out.*=1` асерт `=1`. Це гарантуватиме викидання помилки, якщо та трапиться і за цим селектором буде знайдено більше або менше одного шляху. Наприклад якщо в шляхах ну бед вказано критеріон `debug` тоді буде знайдено обидва шляхи і асерт викене помилку.

За селектром із ґлобом можливо знайти більше одного або навіть жодного ресурса. Якщо розробникові відомо, скільки селектор із ґлобом має знайти ресурсів, то він може вказати це число в якості асерта в селекторі і при виконанні утиліта помітивши, що прогноз розробника не підтвердився викине помилку. Лишати асерти всюди, де точно відомо, який має бути результат виконання -- гарна практика розробки програмного забезпечення. Ґлоб з ассертом - спеціально накладене розробнико обмеження на виконання для попередження непередбачуваних наслідків. Якщо ж селектор простий та нема ґлоба то і асерт не потрібен.    

### Алгоритм перевірки асертів в селекторах

![criterions.and.assert.png](./Images/criterions.and.asserts.png)

Алгоритм виконує перевірку ресурсів на співпадіння [критеріонів](Criterions.md)- при їх співпадінні, утиліта інкрементує лічильник ресурсів. Після перевірки всіх ресурсів значення лічильника порівнюється з встановленим в ассерті. В випадку неспівпадіння значень утиліта видає повідомлення про помилку.  

### Використання ассертів

Ассерт записуєтся після ґлобу та має вигляд `=n`, де `n` - позначає кількість входженнь. Якщо селектор має обирати один ресурс секції `will-файла` то використовується ассерт `=1`.

![asserts.png](./Images/asserts.png)

kos : перепишіть це, будь ласка. Надто довго і не надто очевидний приклад.

На рисунку селектор `step::export.*` в збірці `export` може виконати кроки `export.single` i `export.multi`. Через помилку в `will-файлі` (відсутність критеріонів в кроці `export.multi` - див. [критеріон](Criterions.md)) побудова буде зломана, оскільки, за один крок в сценарії збірки виконується один крок в секції `step`. Без ассертів утиліта `willbe` видасть повідомлення про помилку, яку буде складно локалізувати, а при використанні ассертів в термінал виводиться повідомлення про місце і ресурси, в яких виникла помилка.  Також, розробник обмежив кількість входжень файлів, які починаються на `fileTo` п'ятьма файлами (поле `path: 'fileTo*=5'` в шляху `fileToExport.multi`). Якщо кількість входжень зміниться, то побудова буде відмінена.

![assert.message.png](./Images/assert.message.png)  

На рисунку показано частину повідомлення про помилку в виборі ресурсів для `will-файла` на рисунку вище.  
